<!DOCTYPE html>
<html>
  <head>
    <title>Loopin - 習慣管理アプリ</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="習慣形成をサポートする「Loopin」。バッジ機能やカレンダー表示で、あなたの目標達成を手助けします。">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= favicon_link_tag "/favicon-32x32.png", type: "image/png" %>

    <%# OGP (Open Graph Protocol) meta tags %>
    <meta property="og:title" content="Loopin - 習慣管理アプリ">
    <meta property="og:description" content="習慣形成をサポートする「Loopin」。バッジ機能やカレンダー表示で、あなたの目標達成を手助けします。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="<%= request.original_url %>">
    <meta property="og:image" content="<%= request.base_url %>/ogp.png">
    <meta property="og:site_name" content="Loopin">
    <meta property="og:locale" content="ja_JP">

    <%# Twitter Card meta tags %>
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Loopin - 習慣管理アプリ">
    <meta name="twitter:description" content="習慣形成をサポートする「Loopin」。バッジ機能やカレンダー表示で、あなたの目標達成を手助けします。">
    <meta name="twitter:image" content="<%= request.base_url %>/ogp.png">

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-200R80HTX0"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-200R80HTX0');
  </script>

  </head>

  <body>
    <div id="flash-messages" class="flash-messages container">
    <% flash.each do |key, message| %>
      <div class="alert alert-<%= ['notice', 'success'].include?(key.to_s) ? 'success' : 'danger' %> alert-dismissible fade show" role="alert">
        <%= message %>
        <button type="button" class="btn-close" aria-label="Close">×</button>
      </div>
    <% end %>
    </div>
    <header class="header">
      <nav class="navbar" data-turbo-permanent>
        <div class="container">
          <%= link_to root_path, class: "navbar-brand" do %>
            <%= image_tag "logo.svg", alt: "Loopin", class: "logo" %>
          <% end %>
          <button class="navbar-toggler" id="navbarToggle" aria-label="メニュー">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-nav" id="navbarNav">
            <%= link_to "使い方", how_to_use_path, class: "nav-link" %>
            <% if user_signed_in? %>
              <%= link_to "ログアウト", destroy_user_session_path, "data-turbo-method": :delete, class: "nav-link" %>
              <%= link_to "プロフィール", edit_user_registration_path, class: "nav-link" %>
            <% else %>
              <%= link_to "ログイン", new_user_session_path, class: "nav-link" %>
              <%= link_to "新規登録", new_user_registration_path, class: "nav-link btn-signup" %>
            <% end %>
          </div>
        </div>
      </nav>
    </header>

    <main class="main-content">
      <%= yield %>
    </main>

    <footer class="footer">
      <div class="container">
        <p>&copy; 2025 Loopin. All rights reserved.</p>
        <div class="footer-links">
          <%= link_to "利用規約", page_path("terms"), class: "footer-link" %>
          <%= link_to "プライバシーポリシー", page_path("privacy"), class: "footer-link" %>
        </div>
      </div>
    </footer>
