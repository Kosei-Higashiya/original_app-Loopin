<div class="container mt-4">
  <div class="row">
    <div class="col-12">
<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="bg-primary text-white rounded-3 p-4 mb-4 shadow">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h1 class="mb-2">📌 みんなの習慣掲示板</h1>
            <p class="mb-0">コミュニティのメンバーが共有している習慣の取り組みをご覧ください</p>
          </div>
          <%= link_to "新しい投稿", new_post_path, class: "btn btn-light btn-lg" %>
        </div>
      </div>

      <% if @posts.any? %>
        <div class="row">
          <% @posts.each do |post| %>
            <div class="col-md-6 col-lg-4 mb-4">
              <div class="card h-100 shadow border-2" style="border-color: #28a745; border-radius: 12px;">
                <% if post.image.present? %>
                  <img src="<%= post.image %>" class="card-img-top" alt="投稿画像" style="height: 200px; object-fit: cover; border-radius: 12px 12px 0 0;">
                <% end %>
                <div class="card-body d-flex flex-column p-4" style="background: linear-gradient(145deg, #f8f9fa 0%, #ffffff 100%);">
                  <h5 class="card-title">
                    <span class="badge bg-success mb-2 fs-6" style="border-radius: 8px; padding: 8px 12px;">
                      🎯 <%= post.habit.title %>
                    </span>
                  </h5>
                  <p class="card-text flex-grow-1" style="font-size: 1rem; line-height: 1.5;">
                    <%= truncate(post.content, length: 100) %>
                  </p>
                  <div class="mt-auto border-top pt-3">
                    <small class="text-muted d-block mb-2">
                      👤 <%= post.user.email.split('@').first %> • 
                      ⏰ <%= time_ago_in_words(post.created_at) %>前
                    </small>
                    <% if post.user == current_user %>
                      <div class="text-end">
                        <%= link_to "削除", post_path(post), 
                            data: { 
                              method: :delete,
                              confirm: "本当に削除しますか？"
                            },
                            class: "btn btn-sm btn-outline-danger" %>
                      </div>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-5">
          <div class="card border-2 border-info bg-light p-5" style="border-radius: 15px;">
            <h3 class="text-info mb-3">📝 まだ投稿がありません</h3>
            <p class="text-muted mb-4">最初の投稿をして、コミュニティを盛り上げませんか？</p>
            <%= link_to "投稿する", new_post_path, class: "btn btn-info btn-lg" %>
          </div>
        </div>
      <% end %>

      <div class="mt-4">
        <%= link_to "ダッシュボードに戻る", dashboard_path, class: "btn btn-outline-secondary" %>
      </div>
    </div>
  </div>
</div>